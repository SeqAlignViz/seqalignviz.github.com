<!DOCTYPE html>
<html>
	<head>
	  <meta charset="utf-8" />
		<title>Seq Logo Demo</title>
		
		<script type="text/javascript" src="http://d3js.org/d3.v2.js"></script>
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.js"></script>
		<script type="text/javascript" src="lib/seqLogo/base64.js"></script>
		<script type="text/javascript" src="http://yui.yahooapis.com/2.8.2r1/build/yahoo-dom-event/yahoo-dom-event.js"></script> 
		<script type="text/javascript" src="http://yui.yahooapis.com/2.8.2r1/build/element/element-min.js"></script> 
		<script type="text/javascript" src="http://yui.yahooapis.com/2.8.2r1/build/connection/connection-min.js"></script>
		<script type="text/javascript" src="lib/seqLogo/canvas2image.js"></script>
		<script type="text/javascript" src="lib/seqLogo/canvasSeqLogo.js"></script>
		<script type="text/javascript" src="js/alignment.js"></script>
		<script type="text/javascript" src="js/pwm.js"></script>
		<script src="lib/tipsy/jquery.tipsy.js"></script>
		<link href="lib/tipsy/tipsy.css" rel="stylesheet" type="text/css" />
		<style type="text/css">
			text {
				font-size: 8px;
				text-align: "center";
				vertical-align: "middle";
			}
			rect.extent {
			  stroke: #fff;
			  fill-opacity: .25;
			  shape-rendering: crispEdges;
			}
			.brush .extent {
			  stroke: #000;
			  stroke-width: 2;
			  fill-opacity: .1875;
			  shape-rendering: crispEdges;
			}
			.zoomline {
			  stroke: #000;
			  stroke-width: 2;
			}
			.red {
			}
		</style>
	</head>
	<body>
		<div id="explain" style="width: 100px; height: 100%; left: 0; margin-top: 40 px; position: absolute; ">
Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Integer pretium dui sit amet felis. Integer sit amet diam. Phasellus ultrices viverra velit. Nam mattis, arcu ut bibendum commodo, magna nisi tincidunt tortor, quis accumsan augue ipsum id lorem.
		</div>
		<div id="seqLogo"></div>
		<div id="aln_zoom"></div>
		<div id="aln_full"></div>
		<script type="text/javascript">
		// SVG sizing
		var margin = {top: 40, bottom: 1, left: 40, right: 1}
		dWidth = 960;
		dHeight = 300;
		var width = dWidth - margin.left - margin.right
		var height = dHeight - margin.top - margin.bottom

		// draw seqlogo
		$("#seqLogo")
			.css("width", width+"px")
			.css("height", "40px")
			.css("margin-top", margin.top+"px")
			.css("margin-left", margin.left+100+"px")
			.css("left", "100px")

		var pwm;
		d3.text("dat/small.aln", 
			function (text) { 
				pwm = createPwm(text);
				pwm.drawLogo(YAHOO.util.Dom.get("seqLogo"));						
			});
	
		$("#aln_zoom")
			.css("width", dWidth+"px")
			.css("height", dHeight+"px")
			.css("margin-left", "100px")

		// draw zoom
		var alnTxt = $.ajax({
						url: "dat/small.aln",
						async: false
					 }).responseText;
		lines = alnTxt.replace(/^\s+|\s+$/g,""); // remove white space
		lines = lines.split("\n");
		var aln = Array();
		for (var i = 0; i < lines.length; i++) {
			for (var j = 0; j < lines[i].length; j++) {
				aln.push({val: lines[i][j], row: i, col: j});
			}
		}
		var rows = lines.length;
		var cols = lines[0].length;
		//drawAlignment(aln, rows, cols, d3.select("#aln_zoom"), dWidth, dHeight, true, false);

	
		$("#aln_full")
			.css("width", dWidth+"px")
			.css("height", dHeight+"px")
			.css("margin-left", "100px")
		// draw full
		// Get alignment data
		var stringData = $.ajax({
							url: "dat/test.aln",
							async: false
						 }).responseText;
		var alnArray = [];
		var stringArray = stringData.replace(/^\s+|\s+$/g,"").split("\n");
		for(var i = 0; i < stringArray.length; i++) {
			for(var j = 0; j < stringArray[i].length; j++) {
				alnArray.push({val: stringArray[i][j], row: i, col: j});
			}
		}
		var rows = stringArray.length;
		var cols = stringArray[0].length;
		drawAlignment(alnArray, rows, cols, d3.select("#aln_full"), dWidth, dHeight, false, true);
		</script>
	</body>
</html>
