<!DOCTYPE html>
<html>
	<head>
	  <meta charset="utf-8" />
		<title>Seq Logo Demo</title>
		
		<script type="text/javascript" src="http://d3js.org/d3.v2.js"></script>
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.js"></script>
		<script type="text/javascript" src="lib/seqLogo/base64.js"></script>
		<script type="text/javascript" src="http://yui.yahooapis.com/2.8.2r1/build/yahoo-dom-event/yahoo-dom-event.js"></script> 
		<script type="text/javascript" src="http://yui.yahooapis.com/2.8.2r1/build/element/element-min.js"></script> 
		<script type="text/javascript" src="http://yui.yahooapis.com/2.8.2r1/build/connection/connection-min.js"></script>
		<script type="text/javascript" src="lib/seqLogo/canvas2image.js"></script>
		<script type="text/javascript" src="lib/seqLogo/canvasSeqLogo.js"></script>
		<script type="text/javascript" src="js/alignment.js"></script>
		<script type="text/javascript" src="js/pwm.js"></script>
		<script type="text/javascript" src="lib/bootstrap/js/bootstrap.js"></script>
		<link href="lib/tipsy/tipsy.css" rel="stylesheet" type="text/css" />
		<link href="lib/bootstrap/css/bootstrap.css" rel="stylesheet" type="text/css" />
		<style type="text/css">
			text {
				font-size: 8px;
				text-align: "center";
				vertical-align: "middle";
			}
			.brush .extent {
			  stroke: #000;
			  stroke-width: 2;
			  fill-opacity: .5;
			  shape-rendering: crispEdges;
			}
			.zoomline {
			  stroke: #000;
			  stroke-width: 2;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="row">
				<div class="span4">
					<img src="img/Zoom-In-icon.png" style="height: 50px"/>
				</div>
				<div class="span8 pagination-right">
					<h1>Zoomer!</h1>
				</div>
			</div>
			<div class="row">
				<div class="span12">
				<hr/>
				</div>
			</div>
			<div class="row">
				<div class="span3">
					<h2>Welcome!</h2>
					<p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Integer pretium dui sit amet felis. Integer sit amet diam. Phasellus ultrices viverra velit. Nam mattis, arcu ut bibendum commodo, magna nisi tincidunt tortor, quis accumsan augue ipsum id lorem.</p>
					<div class="accordion" id="legend">
						<div class="accordion-group">
							<div class="accordion-heading">
								<a id="nucleotide" class="btn btn-primary accordion-toggle" onClick="colorScheme('#nucleotide');" data-toggle="collapse" data-parent="#legend" href="#nucleotide-legend">Colored by Nucleotide</a>
							</div>
							<div id="nucleotide-legend" class="accordion-body collapse in">
								<div class="accordion-inner">Nuke</div>
							</div>
						</div>
						<div class="accordion-group">
							<div class="accordion-heading">
								<a id="percentid" class="btn accordion-toggle" onClick="colorScheme('#percentid');" data-toggle="collapse" data-parent="#legend" href="#percentid-legend">Color by % Identity</a>
							</div>
							<div id="percentid-legend" class="accordion-body collapse">
								<div class="accordion-inner">id</div>
							</div>
						</div>
					</div>
				</div>
			<div class="span9">
				<div id="seqLogo"></div>
				<div id="aln_zoom"></div>
				<div id="aln_full"></div>
			</div>
		</div>
		<script type="text/javascript">
		// SVG sizing
		var margin = {top: 20, bottom: 0, left: 0, right: 0}
		dWidth = 700;
		dHeight = 250;
		var width = dWidth - margin.left - margin.right
		var height = dHeight - margin.top - margin.bottom

		// draw seqlogo
		$("#seqLogo")
			.css("width", width+"px")
			.css("height", "40px")
			.css("margin-top", margin.top+"px")
			.css("margin-left", margin.left+"px")

		$("#aln_zoom")
			.css("width", dWidth+"px")
			.css("height", dHeight+"px")

	
		$("#aln_full")
			.css("width", dWidth+"px")
			.css("height", dHeight+"px")
		
		// draw full
		// Get alignment data
		var stringData = $.ajax({
							url: "dat/test.aln",
							async: false
						 }).responseText;
		var alnArray = [];
		var stringArray = stringData.replace(/^\s+|\s+$/g,"").split("\n");
		var percentIdMatrix = computePercentId(stringArray);
		for(var i = 0; i < stringArray.length; i++) {
			for(var j = 0; j < stringArray[i].length; j++) {
				var percentid = 1;//percentIdMatrix[j][stringArray[i][j]];
				alnArray.push({val: stringArray[i][j], percentid : percentid, row: i, col: j});
			}
		}
		var rows = stringArray.length;
		var cols = stringArray[0].length;
		drawAlignment(alnArray, rows, cols, d3.select("#aln_full"), dWidth, dHeight, false, true);
		</script>
	</body>
</html>
