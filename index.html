<!DOCTYPE html>
<html>
	<head>
	  <meta charset="utf-8" />
		<title>Seq Logo Demo</title>
		
		<script type="text/javascript" src="http://d3js.org/d3.v2.js"></script>
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.js"></script>
		<script type="text/javascript" src="lib/seqLogo/base64.js"></script>
		<script type="text/javascript" src="http://yui.yahooapis.com/2.8.2r1/build/yahoo-dom-event/yahoo-dom-event.js"></script> 
		<script type="text/javascript" src="http://yui.yahooapis.com/2.8.2r1/build/element/element-min.js"></script> 
		<script type="text/javascript" src="http://yui.yahooapis.com/2.8.2r1/build/connection/connection-min.js"></script>
		<script type="text/javascript" src="lib/seqLogo/canvas2image.js"></script>
		<script type="text/javascript" src="lib/seqLogo/canvasSeqLogo.js"></script>
		<script type="text/javascript" src="js/alignment.js"></script>
		<script type="text/javascript" src="js/pwm.js"></script>
		<script src="lib/tipsy/jquery.tipsy.js"></script>
		<link href="lib/tipsy/tipsy.css" rel="stylesheet" type="text/css" />
		<style type="text/css">
			text {
				font-size: 8px;
				text-align: "center";
				vertical-align: "middle";
			}
			rect.extent {
			  stroke: #fff;
			  fill-opacity: .25;
			  shape-rendering: crispEdges;
			}
			.brush .extent {
			  stroke: gray;
			  stroke-width: 2;
			  fill-opacity: .1875;
			  shape-rendering: crispEdges;
			}
		</style>
	</head>
	<body>
		<div id="seqLogo"></div>
		<div id="aln_zoom"></div>
		<div id="aln_full"></div>
		<script type="text/javascript">
		// SVG sizing
		var margin = {top: 20, bottom: 0, left: 40, right: 0}
		dWidth = 960;
		dHeight = 300;
		var width = dWidth - margin.left - margin.right
		var height = dHeight - margin.top - margin.bottom

		// draw seqlogo
		$("#seqLogo")
			.css("width", width+"px")
			.css("height", "40px")
			.css("margin-top", margin.top+"px")
			.css("margin-left", margin.left+"px")

		var pwm;
		d3.text("dat/small.aln", 
			function (text) { 
				pwm = createPwm(text);
				pwm.drawLogo(YAHOO.util.Dom.get("seqLogo"));						
			});
	
		$("#aln_zoom")
			.css("width", width+"px")
			.css("height", height+"px")

		// draw zoom
		var alnTxt = $.ajax({
						url: "dat/small.aln",
						async: false
					 }).responseText;
		lines = alnTxt.replace(/^\s+|\s+$/g,""); // remove white space
		lines = lines.split("\n");
		var aln = Array();
		for (var i = 0; i < lines.length; i++) {
			aln.push(lines[i].split(""));
		}
		drawAlignment(aln, d3.select("#aln_zoom"), dWidth, dHeight, true, false);

	
		$("#aln_full")
			.css("width", width+"px")
			.css("height", height+"px")
		// draw full
		// Get alignment data
		var stringArray = $.ajax({
							url: "dat/test.aln",
							async: false
						 }).responseText.split("\n");
		
		// Remove last element, which is an empty string
		stringArray.splice(stringArray.length - 1,1)
		drawAlignment(stringArray, d3.select("#aln_full"), dWidth, dHeight, false, true);
		</script>
	</body>
</html>
